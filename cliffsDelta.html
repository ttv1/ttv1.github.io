<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>cliffsDelta.py</title>
  <link rel="stylesheet" href="pycco.css">
	<link rel="shortcut icon" href="favicon.png" type="image/png">
</head>
<body>
<div id='container'>
<a href="https://github.com/ttv1/src/blob/master/cliffsDelta.py"><img style="z-index: 10; position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/567c3a48d796e2fc06ea80409cc9dd82bf714434/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png"></a> 
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cliffsDelta.py</h1><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(just another timm tool)</p></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

 ga('create', 'UA-55634425-2', 'auto');
 ga('send', 'pageview');

</script>

<p><img 
src="https://avatars0.githubusercontent.com/u/23156192?v=3&s=200"
align=left
width=120>
&nbsp;<br>&nbsp;<br>
&nbsp;&nbsp; <a href="http://ttv1.github.io">home</a> | <a href="#discussion">discuss</a> | <a href="https://github.com/ttv1/src/issues">report bug</a>
<!-- br>
<script>
 (function() {
   var cx = '009630129455493240085:aja5uvdnjeo';
   var gcse = document.createElement('script');
   gcse.type = 'text/javascript';
   gcse.async = true;
   gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(gcse, s);
 })();
</script>
<gcse:search></gcse:search ---> </p>
<p><br clear=all></p>
<hr />
<p>Returns True if two lists of numbers are different by only a trivially small amount.</p>
<p>This is a non-parametric effect size test. Computes the probability that list2 has smaller
or larger numbers than list1. Two lists are the same if that probability is less
tha some <code>trivial</code> amount.</p>
<p>The size of <code>trivial</code> can be adjusted by an optional third argument.
The following values for this argument are recommented:</p>
<ul>
<li>large  = 0.474</li>
<li>medium = 0.33</li>
<li>small  = 0.147 <ul>
<li>Use this one to test that lists are different by more than a small effect.</li>
<li>This is the default value.</li>
</ul>
</li>
</ul>
<h3>Reference:</h3>
<p>Romano, Jeanine, et al. <a href="http://www.coedu.usf.edu/main/departments/me/documents/methodsforevaluatinggroup.pdf">Exploring methods for evaluating group differences on
the NSSE and other surveys: Are the t-test and Cohen's d indices the most
appropriate
choices</a>,
Annual meeting of the Southern Association for Institutional Research. 2006.</p>
<h3>Example</h3>
<p>This example compare two lists that differ by an ever growing amont.
Note that, until we starting adding more than about 1.5, the two
lists are deemed to be the same.</p>
<pre><code> from cliffsDelta import cliffsDelta
 from random import random as r
 #
 base = [r()*10 for _ in range(30)]
 print([round(x,4) for x in sorted(base)])
 for n in range(1,8,1):
   other = [x+ (r()*n/2) for x in base]
   print(n/2, 
         cliffsDelta(base, other))

 # output
 [0.0211, 0.2545, 0.2835, 0.2904, 0.3059, 0.9386, 
  1.3436, 2.166, 2.2169, 2.2876, 2.5507, 3.812, 
  4.2212, 4.3277, 4.3789, 4.4539, 4.4949, 4.9544, 
  4.9581, 5.4141, 6.5159, 7.2154, 7.6228, 7.6377, 
  7.8872, 8.3577, 8.4743, 9.0143, 9.3915, 9.4527]
   0.5 True   
   1.0 True
   1.5 False   # &lt;=== first time we see a difference.
   2.0 False
   2.5 False
   3.0 False
   3.5 False
</code></pre>
<hr />
<h2>Programmer's guide</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>Returns <code>True</code> if two lists of numbers are similar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">cd</span><span class="p">(</span><span class="n">lst1</span><span class="p">,</span><span class="n">lst2</span><span class="p">,</span> <span class="n">trivial</span><span class="o">=</span><span class="mf">0.147</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>This file includes a simple (and slow) version of cliffsDelta plus a trickier
(and faster) one that takes advantage of sorted lists and repeated values.</p>
<p>As shown by the <a href="cliffsDeltaeg.py">_fastWorks</a> function 
(in the test file):</p>
<ul>
<li>both give the same results</li>
<li>when using pypy3, for lists less that 512 in size, there is little difference.</li>
<li>when using python, lsts on size 2n take twice as long with cdSimple than with
  cdTricky</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre>  <span class="n">f</span> <span class="o">=</span> <span class="n">optimized</span> <span class="k">if</span> <span class="n">fast</span> <span class="k">else</span> <span class="n">basic</span>
  <span class="n">lt</span><span class="p">,</span><span class="n">gt</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">lst1</span><span class="p">,</span><span class="n">lst2</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">gt</span><span class="o">-</span><span class="n">lt</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">1e-32</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">trivial</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <hr />
<h3>Two methods for colelcting the required stats.</h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>Method #1: simple, slow. Shows the basic idea.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">basic</span><span class="p">(</span><span class="n">lst1</span><span class="p">,</span><span class="n">lst2</span><span class="p">):</span>
  <span class="n">lt</span><span class="o">=</span><span class="n">gt</span><span class="o">=</span><span class="n">n</span><span class="o">=</span><span class="mi">0</span>
  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lst1</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">lst2</span><span class="p">:</span>
      <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">:</span> <span class="n">gt</span> <span class="o">+=</span><span class="mi">1</span>
      <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">:</span> <span class="n">lt</span> <span class="o">+=</span><span class="mi">1</span>
  <span class="k">return</span> <span class="n">lt</span><span class="p">,</span><span class="n">gt</span><span class="p">,</span><span class="n">n</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Method #2: trickier, much faster method.
Not novice friendly.
Exploits sorted lists, repeated values.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">optimized</span><span class="p">(</span><span class="n">lst1</span><span class="p">,</span><span class="n">lst2</span><span class="p">):</span>  
  <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst2</span><span class="p">)</span>
  <span class="n">lst2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">lst2</span><span class="p">)</span>
  <span class="n">j</span> <span class="o">=</span> <span class="n">gt</span> <span class="o">=</span> <span class="n">lt</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">repeats</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="n">runs</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">lst1</span><span class="p">)):</span>
    <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">lst2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span>  <span class="n">x</span><span class="p">:</span> 
      <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">gt</span> <span class="o">+=</span> <span class="n">j</span><span class="o">*</span><span class="n">repeats</span>
    <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">lst2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span> 
      <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">lt</span> <span class="o">+=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">repeats</span>
  <span class="k">return</span> <span class="n">lt</span><span class="p">,</span><span class="n">gt</span><span class="p">,</span><span class="n">m</span><span class="o">*</span><span class="n">n</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <hr />
<h3>Helper function</h3>
<p>Generator.  Yields runs of repeated items as  count,item.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">runs</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span> 
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">two</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">one</span><span class="p">,</span><span class="n">i</span> <span class="o">=</span> <span class="n">two</span><span class="p">,</span><span class="mi">0</span>
      <span class="k">if</span> <span class="n">one</span><span class="o">!=</span><span class="n">two</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">j</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span><span class="n">one</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">j</span>
      <span class="n">one</span> <span class="o">=</span> <span class="n">two</span>
    <span class="k">yield</span> <span class="n">j</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="n">two</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <hr />
<p><img align=right 
src="https://raw.githubusercontent.com/timm/timm.github.io/master/timm.png"
width=170></p>
<h2>Copyleft</h2>
<p>Copyright &copy; 2016 Tim Menzies <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#116;&#105;&#109;&#64;&#109;&#101;&#110;&#122;&#105;&#101;&#115;&#46;&#117;&#115;">&#116;&#105;&#109;&#64;&#109;&#101;&#110;&#122;&#105;&#101;&#115;&#46;&#117;&#115;</a></p>
<p>This program is free software. It comes without any warranty, to
the extent permitted by applicable law. You can redistribute it
and/or modify it under the terms of the Do What The F*ck You Want
To Public License, Version 2, as published by Sam Hocevar. See
<a href="http://www.wtfpl.net">http://www.wtfpl.net</a> for more details.</p>
<p>Share and enjoy.</p>

<hr>
<a name="discussion"><h2>Discussion</h2></a>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
 var disqus_config = function () {
this.page.url = 'https://ttv1.github.ip/cliffsDelta.html'
this.page.identifier = 'cliffsDelta';
 };
 */
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//ttv1.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  </div>
  <div class='code'>
    <div class="highlight"><pre></pre></div>
  </div>
</div>
<div class='clearall'></div>
</div>
<script id="dsq-count-scr" src="//ttv1.disqus.com/count.js" async></script>
</body>
</html>
